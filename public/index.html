// public/index.html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>pres</title>
  <style>
    body { margin:0; font-family: sans-serif; display:flex; height:100vh; }
    #users { width:25%; border-right:1px solid #ddd; padding:10px; }
    #chat { flex:1; display:flex; flex-direction:column; }
    #header { display:flex; justify-content:space-between; align-items:center; }
    #messages { flex:1; overflow:auto; }
    #input { display:flex; }
    #adminBtn { background:red; color:white; display:none; }
    #logo {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 26px;
  font-weight: 700;
  color: #1e88e5;
}

#logo .icon {
  font-size: 30px;
}

#messages {
  flex: 1;
  overflow-y: auto;
  padding: 15px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  background: #f0f2f5;
}

.message {
  display: flex;
}

.my-message {
  justify-content: flex-end;
}

.other-message {
  justify-content: flex-start;
}

.bubble {
  max-width: 60%;
  padding: 10px 14px;
  border-radius: 18px;
  font-size: 14px;
  line-height: 1.4;
}

.my-message .bubble {
  background-color: #dcf8c6;
  border-bottom-right-radius: 5px;
}

.other-message .bubble {
  background-color: white;
  border-bottom-left-radius: 5px;
  border: 1px solid #ddd;
}

#header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 15px;
  border-bottom: 1px solid #ddd;
}

#marketBox {
  font-size: 14px;
  background: #f5f5f5;
  padding: 6px 10px;
  border-radius: 8px;
}

  </style>
</head>
<body>

  <div id="header">
  <div id="logo">
    <span class="icon">ðŸ’¬</span> pres
  </div>

  <div id="marketBox">
    Gold: <span id="goldPrice">--</span> |
    BTC: <span id="btcPrice">--</span>
  </div>

  <button id="adminBtn">Admin</button>
</div>


      <button id="adminBtn">Admin</button>
    </div>
    <div id="messages"></div>
    <div id="input">
      <input id="msg" placeholder="message" />
      <button onclick="send()">Send</button>
    </div>
  </div>
<div id="adminPanel" style="display:none; position:absolute; top:50px; right:20px; background:#f5f5f5; border:1px solid #ccc; padding:10px;">
  <h3>Admin Panel</h3>
  <input id="kickUser" placeholder="Username to kick" />
  <button onclick="kick()">Kick</button><br/>
  
  <input id="muteUser" placeholder="Username to mute" />
  <input id="muteMinutes" placeholder="Minutes" type="number"/>
  <button onclick="mute()">Mute</button><br/>
  
  <input id="broadcastMsg" placeholder="Broadcast message"/>
  <button onclick="broadcast()">Send</button><br/>
  
  <input id="newAdminPass" placeholder="New Admin Password"/>
  <input id="newPublicPass" placeholder="New Public Password"/>
  <button onclick="changePasswords()">Change Passwords</button>

  <h4>Change Background Color</h4>
<button onclick="changeBg('white')">White</button>
<button onclick="changeBg('lightblue')">Blue</button>
<button onclick="changeBg('lightgreen')">Green</button>

<h4>Change Chat Background</h4>
<button onclick="changeChatColor('lightgreen')">Green</button>
<button onclick="changeChatColor('lightblue')">Blue</button>

</div>

<script src="/socket.io/socket.io.js"></script>

<script>

  const socket = io();
  const username = prompt('username');
  const password = prompt('password');

  socket.emit('login', { username, password });

  socket.on('loginSuccess', (data) => {
    if (data.role === 'admin') document.getElementById('adminBtn').style.display='block';
  });

  socket.on('loginError', () => alert('login failed'));

  socket.on('users', users => {
    document.getElementById('userList').innerHTML = users.map(u=>`<li>${u}</li>`).join('');
  });

  socket.on('chat', data => {
  const messageDiv = document.createElement('div');
  messageDiv.classList.add('message');

  if (data.user === username) {
    messageDiv.classList.add('my-message');
  } else {
    messageDiv.classList.add('other-message');
  }

  messageDiv.innerHTML = `
    <div class="bubble">
      <strong>${data.user}</strong><br/>
      ${data.msg}
    </div>
  `;

  document.getElementById('messages').appendChild(messageDiv);
  document.getElementById('messages').scrollTop =
    document.getElementById('messages').scrollHeight;
});


socket.on('changeChatColor', (color) => {
  document.getElementById('chat').style.backgroundColor = color;
});


  function send() {
    socket.emit('chat', document.getElementById('msg').value);
    document.getElementById('msg').value='';
  }
// ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ† Ø¨Ø§ Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡
document.getElementById('adminBtn').onclick = () => {
  const panel = document.getElementById('adminPanel');
  panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
}

// ØªÙˆØ§Ø¨Ø¹ Ø§Ø¯Ù…ÛŒÙ†
function kick() {
  const user = document.getElementById('kickUser').value;
  socket.emit('adminAction', { type:'kick', user });
}

function mute() {
  const user = document.getElementById('muteUser').value;
  const minutes = parseInt(document.getElementById('muteMinutes').value) || 1;
  socket.emit('adminAction', { type:'mute', user, minutes });
}

function broadcast() {
  const msg = document.getElementById('broadcastMsg').value;
  socket.emit('adminAction', { type:'broadcast', msg });
}

function changePasswords() {
  const newAdmin = document.getElementById('newAdminPass').value;
  const newPublic = document.getElementById('newPublicPass').value;
  socket.emit('adminAction', { type:'changePasswords', newAdmin, newPublic });
}

function changeBg(color) {
  const panel = document.getElementById('adminPanel');
  panel.style.backgroundColor = color;
}

function changeChatColor(color) {
  socket.emit('adminAction', { type: 'changeChatColor', color });
}

socket.on('marketData', data => {
  document.getElementById('goldPrice').innerText = data.gold;
  document.getElementById('btcPrice').innerText = data.btc;
});


</script>
</body>
</html>